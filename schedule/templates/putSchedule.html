<html>
<head>
    {% load staticfiles %}
    <script src="{% static 'js/jquery-1.10.2.js' %}"></script>
    <script src="{% static 'js/dynamicTable.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js"></script>
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <script src="{% static 'js/bootstrap.min.js' %}"></script>

    <style>
        .thstyle2{
            text-align:center;
            width: 26%;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="col-md-12 table-responsive">
                    <div class="row">
                        <div class="col-md-4">
                            <label>DAY:</label>
                            <select name = "day" class="form-control" id="{{contact.id}}gid" form="scheduleform">
                              <option value="월" selected>월</option>
                              <option value="화">화</option>
                              <option value="수">수</option>
                              <option value="목">목</option>
                              <option value="금">금</option>
                              <option value="토">토</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label>CAR:</label>
                            <select name = "carnum" class="form-control" id="{{contact.id}}gid" form="scheduleform">
                              <option value="" selected>호차</option>
                              {% for g in group %}
                              <option  value="{{g.gid}}">{{g.gname}}</option>
                              {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-4">
                        </div>
                    </div>
                    <br>
                    <table class="table table-bordered" id="table-schedule">
                        <thead>
                            <tr>
                                <th class="text-center">시간</th>
                                <th class="text-center thstyle2">주소</th>
                                <th class="text-center thstyle2">이름</th>
                                <th class="text-center">학원선택</th>
                                <th class="text-center">선택학원</th>
                                <th class="text-center">등하원</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- <tr class="hidden data">
                                <td data-name="time">
                                    <input type="text" name='time' placeholder='Time' class="form-control" form="scheduleform"/>
                                </td>
                                <td data-name="addr">
                                    <input type="text" name='addr' placeholder='Address' class="form-control" form="scheduleform"/>
                                </td>
                                <td data-name="name">
                                    <input type="text" name='name' placeholder='Name' class="form-control" form="scheduleform"/>
                                </td>
                                <td data-name="sel">
                                    <select class="form-control" onchange="addAca(this)">
                                        <option value="">학원선택</option>
                                        {% for a in academy %}
                                        <option value = "{{a.id}}">{{a.name}}({{a.id}})</option>
                                        {% endfor %}
                                      </select>
                                    <br>
                                    <br>
                                </td>
                                <td data-name="academy">
                                  <input type="text" name='academy' class="form-control" form="scheduleform"/>
                                </td>
                                <td data-name="load">
                                    <select name="load" form="scheduleform"/>
        				                        <option value="">등하원</option>
    					                          <option value="1">등원</option>
        				                        <option value="2">하원</option>
						                        </select>
                                </td>
                                <td data-name="move">
                                    <a href="javascript:void(0)" class="glyphicon glyphicon-chevron-up up"></a>
                                    <a href="javascript:void(0)" class="glyphicon glyphicon-chevron-down down"></a>
                                </td>
                                <td data-name="del">
                                    <button name="del" class='btn btn-danger glyphicon glyphicon-remove row-remove'></button>
                                </td>
                            </tr>-->
                        </tbody>
                    </table>
                  </div>
                  <input class="hidden" name="bid" value="{{bid}}" form="scheduleform"/>
                  <form action="putSchedule" method="post" enctype='application/json' id="scheduleform">
                      <input type="submit" class="btn btn-success pull-right" >
                  </form>
                <a id="add" class="btn btn-default pull-right" onclick="emptyTempList();">Add Row</a>

            </div>
            <!-- <div id="recommand_inven" class="col-md-3">
                <div class="row affix bg-info">
                    <h3 align="center">인벤토리추천</h3>
                    <br>
                    <label for="exampleInputEmail1">요일</label>
                    <select class="form-control" id="{{contact.id}}gid">
                        <option value="" selected>월</option>
                        <option value="">화</option>
                        <option value="">수</option>
                        <option value="">목</option>
                        <option value="">금</option>
                        <option value="">토</option>
                      </select>
                    <label for="exampleInputEmail1">시작시간</label>
                    <input type="email" class="form-control" placeholder="시작시간">

                    <br>
                    <a class="btn btn-default pull-right">검색</a>
                </div>
            </div>-->
        </div>

</body>
<script>
var tempList = new Array();

function addAca(selected) {
    tempList.push(selected.value);
    selected.parentNode.parentNode.children[4].children[0].value = tempList;
    console.log(selected.parentNode.parentNode.children[4].children[0].value)
}


function emptyTempList(){
    tempList.splice(0,tempList.length);
}

$('#add').click(function(){
    $('#table-schedule').append('<tr><td data-name="time"><input onchange="emptyTempList();" type="text" name="time[]" placeholder="Time" class="form-control" form="scheduleform"/></td><td><input type="text" name="addr[]" placeholder="Address" class="form-control" form="scheduleform"/></td><td data-name="name"><input type="text" name="name[]" placeholder="Name" class="form-control" form="scheduleform"/></td><td data-name="sel"><select class="form-control" onchange="addAca(this)"><option value="">학원선택</option>{% for a in academy %}<option value = "{{a.id}}">{{a.name}}({{a.id}})</option>{% endfor %}</select></td><td data-name="academy"><input type="text" name="academy[]" class="form-control" form="scheduleform"/></td><td data-name="load"><select name="load[]" form="scheduleform"><option value="">등하원</option><option value="1">등원</option><option value="2">하원</option></select></td><td data-name="move"><a href="javascript:void(0)" class="glyphicon glyphicon-chevron-up up"></a><a href="javascript:void(0)" class="glyphicon glyphicon-chevron-down down"></a></td><td data-name="del"><button name="del" class="btn btn-danger glyphicon glyphicon-remove row-remove"></button></td></tr>');
});

$('#table-schedule').on('click','.up,.down',function() {
  var row = $(this).parent().parent();
      if ($(this).is(".up")) {
          row.each(function(){
              var previndex=$(this).prev().index();
              if(previndex>=0){
                  var rowindex=$(this).index();
                  $(this).attr("id",previndex);
                  $(this).prev().attr("id",rowindex);
                  $(this).insertBefore($(this).prev());
              }
          });
      } else {
          $(row.get().reverse()).each(function(){
              var nextindex=$(this).next().index();
              if(nextindex>=0){
                  var rowindex=$(this).index();
                  $(this).attr("id",nextindex);
                  $(this).next().attr("id",rowindex);
                  $(this).insertAfter($(this).next());
              }
          });
      }
});

$("#table-schedule").on('click','.row-remove', function(event) {
    $(this).parent().parent().remove();
});
</script>

</html>
